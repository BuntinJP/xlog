---
title: "Obsidianã®ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åŒæœŸã‚’ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã™ã‚‹[Selfhosted Live Sync]"
description: æœˆ5ãƒ‰ãƒ«ã¯ä¹é£Ÿã«ã¯é«˜ã™ãã¾ã™ğŸ¥²
date: 2026-01-06
categories: ['å·¥ä½œ','ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆ']
tags: ['Obsidian','Docker']
draft: true
---

## ã¯ã˜ã‚ã«

è‡ªåˆ†ã¯ãƒ¡ãƒ¢ãƒ„ãƒ¼ãƒ«ã«ã“ã ã‚ã‚‹ã®ãŒçµæ§‹å¥½ããªã‚¿ã‚¤ãƒ—ãªã®ã§ã™ãŒã€æ°—ã«ãªã‚‹ã‚¢ãƒ—ãƒªã‚’è¤‡æ•°ç«¯æœ«ã§ç„¡è¨ˆç”»ã«å°å…¥ã—ãŸã›ã„ã§ã€é€†ã«ç®¡ç†ã—ãã‚Œãªããªã£ã¦ã—ã¾ã„ã¾ã—ãŸç¬‘  

æƒ…å ±ãŒç«¯æœ«ã«ã‚ˆã£ã¦æ‹¡æ•£ã™ã‚‹ã®ãŒã‚¹ãƒˆãƒ¬ã‚¹ã§ä»•æ–¹ãªã„ã®ã§ã€1ã¤ã®ã‚¢ãƒ—ãƒªã«ã«ã™ã¹ã¦ã‚’é›†ç´„ã—ã‚ˆã†ã¨æ€ã„ã€é¸ã°ã‚ŒãŸã®ã¯ã€ŒObsidianã€ã§ã—ãŸã€‚  
Apple Notes(ãƒ¡ãƒ¢)ãŒæœ¬å½“ã«ãŠæ°—ã«å…¥ã‚Šãªã®ã§ã€ã‹ãªã‚Šè¾›ã„é¸æŠã§ã™ãŒã€ã©ã†ã«ã‹é©å¿œã—ã‚ˆã†ã¨æ€ã„ã¾ã™ğŸ¥¹

ã‚¢ãƒ—ãƒªã®é¸å®šã‚’çµ‚ãˆã¦æ€ã†ã®ã¯ã€ç§ã«ã¨ã£ã¦ä¸€ç•ªå¤§åˆ‡ãªã®ã¯ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚ã‚‹ã“ã¨ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚ 
ç¾åœ¨ã®æƒ…å ±ã®æ‹¡æ•£ã‚‚ã€ãã“ã«åŸå› ãŒã‚ã‚‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

æ‰‹è»½ãªã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ¡ãƒ¢ãƒ„ãƒ¼ãƒ«ã¨ãªã‚‹ã¨ã€NotionãŒæµ®ä¸Šã—ã¦ãã¾ã™ã€‚   
è‰¯ã„ã‚¢ãƒ—ãƒªã§ã¯ã‚ã‚Šã¾ã™ã€‚ãŒã€LLMã«è¨˜è¿°å†…å®¹ã‚’èª­ã¾ã›ãŸã‚Šãªã©ã€ãã“ã‹ã‚‰ã®æ‹¡å¼µã‚’è‡ªåŠ›ã§ã‚„ã‚‹ã¨ãªã£ãŸæ™‚ã€é™ç•ŒãŒæ¥ã‚‹ã‚ˆã†ãªæ°—ãŒã—ã¦ã„ã¾ã™ã€‚  
ã¾ãŸã€ç›®ç‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ­£ç›´è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ã¯ç„¡ç”¨ãªã®ã¨ã€AIé–¢é€£ã§ãƒ­ãƒƒã‚¯ã‚¤ãƒ³ã•ã‚Œãªã„ã‹ãªã©ã®æ‡¸å¿µãŒã‚ã‚Šã¾ã™ã€‚
Slackã®AIãƒ­ãƒƒã‚¯ã‚¤ãƒ³ãŒæœ¬å½“ã«æ°—æŒã¡æ‚ªã„ã§ã™ãŒã€ãã‚Œã¨åŒã˜é›°å›²æ°—ã‚’Notionã‹ã‚‰ã‚‚æ„Ÿã˜ã¦ã„ã¾ã™ã€‚

Apple Notes(ãƒ¡ãƒ¢)ã¯ã€ã‚¢ãƒ—ãƒªã®ä½¿ç”¨æ„Ÿã ã‘ã§è¨€ãˆã°ç©¶æ¥µã®ç¥ã§ã™ã€‚æµçŸ³ã¯Appleã¨ã„ã£ãŸã¨ã“ã‚ã§ã™ã€‚æœ¬å½“ã«ã€‚  
ã—ã‹ã—ã€ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨ã„ã†ç‚¹ã§è¨€ãˆã°ã‚´ãƒŸã§ã™ã€‚Androidã€ã‚´ãƒŸOS(Windows)ã§ã‚‚å‹•ã„ã¦ã»ã—ã„ã§ã™ã€‚

ãã®ãŸã‚ã€ã‚ãã¾ã§ãŸã ã®Markdownã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ã‚ã‚‹ObsidianãŒè‰¯ãå†™ã£ãŸã¨ã„ã†ã‚ã‘ã§ã™ã€‚

## Obsidian Syncã¯é«˜ã™ãã‚‹

ã˜ã‚ƒã‚Obsidianã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è‰¯ã„ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã‚¢ãƒ—ãƒªãªã®ã‹ã¨ã„ã†ã¨ã€ãã†ã§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚

å…¬å¼ã®Obsidian SyncãŒæ–™é‡‘ã‚’è€ƒãˆãªã„å ´åˆã¯ã€æœ€é«˜ã®é¸æŠè‚¢ã§ã™ã€‚  
ã—ã‹ã—ã€å…¬å¼ã¸ã®ãŠç¤¼ã¨ã—ã¦å½“ãŸã‚Šå‰ã«æ”¯æ‰•ãˆã‚‹Redditã®æµ·å¤–å‹¢(ãã†ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã‹ã‘ã‚‹ã ã‘ã§ã™)ã¨ã¯ç•°ãªã‚Šã€ç§ã¯ä¹é£Ÿã§ã™ã€‚  
ãªã‘ãªã—ã®5ãƒ‰ãƒ«(å¹´æ›´æ–°ã§4ãƒ‰ãƒ«)ã®ã‚µãƒ–ã‚¹ã‚¯ã¯ã€ã¡ã‚‡ã£ã¨æŠµæŠ—æ„ŸãŒã‚ã‚Šã¾ã™ã€‚ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ã‚¹ãƒˆãŒã€ä½¿ã„ç¶šã‘ã‚‹ã¨ã„ã†ãƒ¢ãƒãƒ™ã«å¯¾ã—å¤§ããªæŠµæŠ—ã¨ãªã‚‹ã®ã§ã€ã‚µãƒ¼ãƒãƒ¼ã‚’ã†ã¾ãåˆ©ç”¨ã—ã¦ã‚±ãƒã‚‹æ–¹å‘ã§é ‘å¼µã‚Šã¾ã™ã€‚

ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼åŒæœŸã¨å‘¼ã°ã‚Œã¦ã„ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç”¨ã„ãŸåŒæœŸã§ã€æœ€ã‚‚è‰¯ã•ãã†ãªã‚‚ã®ã‚’ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã™ã‚‹æ–¹å‘ã§é€²ã‚ã¾ã™ã€‚  
ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå¤šãã‚ã‚Šã€iPhoneãªã©ç¸›ã‚Šä»˜ã‘ãŒå³ã—ãã†ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚‚åˆ©ç”¨ã§ãã‚‹æ‰€ãŒã€ä»–ã®ãƒ¡ãƒ¢ã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦ObsidianãŒå¤§ãããƒªãƒ¼ãƒ‰ã™ã‚‹ç‚¹ã ã¨æ€ã„ã¾ã™ã€‚

## Self-hosted LiveSync

[obsidian-livesync](https://github.com/vrtmrz/obsidian-livesync)

Obsidianã®ã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ãªã‚Šã¾ã™ã€‚  
ç„¡æ–™ã§åˆ©ç”¨ã§ãã€ã‹ã¤ã‚µãƒ¼ãƒãƒ¼ã¯ã‚³ãƒ³ãƒ†ãƒŠ1ã¤ã§ã™ã€‚ç¾ã—ã„ã§ã™ã­ã€‚ã—ã‹ã—ã€å¾Œè¿°ã—ã¾ã™ãŒä¸€ã¤ã ã‘ã§ã‹ã„ç–µãŒã‚ã‚Šã¾ã™ã€‚

è‰²ã€…ãªåŒæœŸãƒ„ãƒ¼ãƒ«ã‚’èª¿ã¹ã¾ã—ãŸãŒã€ä¸€ç•ªã“ã‚ŒãŒè‰¯ã•ãã†ã§ã™ã€‚  
å³æ™‚åŒæœŸã§ã‚ã‚‹å¿…è¦ã¯ãªã„ã®ã§ã™ãŒã€ã“ã¡ã‚‰ã®å ´åˆå³æ™‚æ€§ã‚‚ã‹ãªã‚Šé«˜ãã†ã§ã™ã€‚

ç«¶åˆã®è§£æ±ºã‚‚ã€ã‚ˆãåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹Syncthingã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚ˆã‚Šè‰¯ã•ãã†ã«æ„Ÿã˜ã¾ã—ãŸã€‚
Syncthingã¯ç°¡å˜ã«è¨€ã†ã¨ã€ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ã®å†…éƒ¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’rcloneã®ã‚ˆã†ã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨åŒæœŸã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚·ãƒ¥ã€mtimeã‚’åŸºæº–ã«ã™ã‚‹rsyncæ–¹å¼ã§åŒæœŸã‚’è¡Œã†ãŸã‚ã€ç«¶åˆè§£æ±ºã®ãƒ­ã‚¸ãƒƒã‚¯ãŒå˜ç´”ãªä¸Šæ›¸ãã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ã—ã‹ã—ã€Self-hosted LiveSyncã®å ´åˆã¯Obsidianã®ç·¨é›†ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã®åŒæœŸãŒè¡Œã‚ã‚Œã¾ã™ã€‚æœ€é«˜ã§ã™ã€‚

å†…éƒ¨ã§JSONãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€CouchDBã‚’åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã§ã™(S3ã‚‚é¸æŠå¯èƒ½ã ãŒå®Ÿé¨“çš„)ã€‚  
Apache CouchDBã¯ã€JSONãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä¿å­˜ã™ã‚‹NoSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã€
ã™ã¹ã¦ã®æ“ä½œã‚’HTTP REST APIçµŒç”±ã§è¡Œã†ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚

â€¦ Apacheè²¡å›£ã ã‹ã‚‰OKã§ã™ç¬‘

ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã¯ã€ç§ãŒæ¢ã—ãŸã¨ã“ã‚(ChatGPT,Geminiã«èã„ãŸã¨ã“ã‚)ã€IBM Cloudantã—ã‹ãªã„ã¨ã®ã“ã¨ã§ã—ãŸã€‚  
ç„¡æ–™æ 1GBã®ãã®1ã¤ä¸Šã®ãƒ—ãƒ©ãƒ³ãŒæœˆé¡1ä¸‡1000å††ã®ã‚¨ãƒ³ãƒ—ãƒ©å‘ã‘ã‚¢ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã®ãŸã‚ã€ã¾ã‚æ­£ç›´çœ¼ä¸­ã«ã‚ã‚Šã¾ã›ã‚“ã€‚

ã¨æ€ã£ãŸã‚‰Self-hostedã£ã¦æ›¸ã„ã¦ã‚ã‚Šã¾ã—ãŸç¬‘

ä»–ã®ãƒ–ãƒ­ã‚°ã‚’è¦‹ã¦ã‚‹ã¨ã€`fly.io`ã¨ã‹ã„ã†ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ä¼šç¤¾ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸­ã§è§¦ã‚Œã‚‰ã‚Œã¦ã„ã‚‹ãŸã‚ã‹ãã¡ã‚‰ã‚’åˆ©ç”¨ã—ã¦ãƒ›ã‚¹ãƒˆã—ã¦ã„ã‚‹äººãŒå¤šã‚ã®å°è±¡ã§ã™ã€‚  
ã—ã‹ã—ã€æ³¨æ„ã—ã¦æ¬²ã—ã„ã®ã¯ç„¡æ–™æ ã¯æœ€åˆã®5ãƒ‰ãƒ«åˆ†ã®ã¿ã¨ã„ã†ãŸã ã®è©æ¬ºã§ã™ã€‚ã”æ³¨æ„ãã ã•ã„ã€‚

ã‚³ãƒ³ãƒ†ãƒŠã‚’ä¹é£Ÿçš„ã«ãƒ›ã‚¹ãƒˆã™ã‚‹ãªã‚‰ã°ã€ãŠã™ã™ã‚ã¯ã€Œ[zeabur](https://zeabur.com/)ã€ã§ã™ã€‚ã“ã¡ã‚‰ã¯ä»Šã ã«ç„¡æ–™ã§æ¯æœˆ5ãƒ‰ãƒ«åˆ†ã®ã‚¯ã‚ªãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚

## æ§‹æˆ

è‡ªå®…ã‚µãƒ¼ãƒãƒ¼ã®Docker, Nginxã‚’åˆ©ç”¨ã—ã¾ã™ã€‚  
Nginxã§ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã—ã¦ã€å°‚ç”¨ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’VHã¨ã—ã¦ãƒ›ã‚¹ãƒˆã—ã¾ã™ã€‚

DBã‚’å…¨å…¬é–‹ã™ã‚‹ã¨ã„ã†ã¨ã‚“ã§ã‚‚ãªã„è¡Œç‚ºã§ã™ãŒã€å…¬å¼ãŒã‚„ã‚Œã¨ã„ã†ã®ã§ä»•æ–¹æœ‰ã‚Šã¾ã›ã‚“ã€‚  
AIæ›°ãä¸€å¿œ(E2EEã‚’é€šã›ã°ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’é€šã˜ã¦)ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£çš„ã«å®‰å…¨ã‚‰ã—ã„ã§ã™ã€‚

ã—ã‹ã—ã€CouchDBã«è„†å¼±æ€§ãŒå­˜åœ¨ã—ã¦ã‚¼ãƒ­ãƒ‡ã‚¤ã§çªã‹ã‚ŒãŸã‚‰çµ‚ã‚ã‚Šãªæ°—ãŒã™ã‚‹ã®ã§ã€æ°—ãŒå‘ã„ãŸã‚‰TailscaleçµŒç”±ã«å¤‰æ›´ã™ã‚‹ã‹ã‚‚ã§ã™ã€‚

CouchDBã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’åŸºæº–ã«ã€èªè¨¼ã«å¤±æ•—ã—ã¾ãã£ã¦ã„ã‚‹IPã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ãŸã‚Šã€ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’åˆ©ç”¨ã—ã¦äºŒé‡ã«é˜²å¾¡ã™ã‚‹ã¨ã‹ã—ãŸã„ã§ã™ãŒä¸å¯èƒ½ã§ã™ã€‚
å…¬å¼ãŒãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚’æ¨å¥¨ã—ã¦ã„ã¦ã„ã¦ã€ãŸã ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã§ã¯Webã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šã‚’ã‚ã¾ã‚Šè¤‡é›‘ã«ã§ããªã„ã®ãŒåŸå› ãªæ°—ãŒã—ã¾ã™ã€‚

## è¨­å®šæ–¹æ³•

### 1. CouchDBã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¦ã‚‹

Dockerã§CouchDBã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ã„ã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¦ã¾ã™ã€‚

compose.ymlã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®šã‚’è¡Œã£ã¦ãŠã‚Šã€ãã®æƒ…å ±(`CHAME_ME`)ãŒå¤–éƒ¨ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã‚’å®ˆã‚‹å”¯ä¸€ã®æ‰‹æ®µ(Basicèªè¨¼ğŸ˜­)ã«ãªã‚Šã¾ã™ã€‚

ã‚³ãƒãƒ³ãƒ‰

```console
>$ mkdir ~/apps/obsidian-livesync                                                               
>$ cd ~/apps/obsidian-livesync                                                                  
>$ vim compose.yml
>$ sudo mkdir -p couchdb-config
>$ mkdir -p couchdb-data
>$ sudo vim couchdb-config/local.ini
>$ sudo chown -R 5984:5984 couchdb-data couchdb-config
>$ docker compose up -d
```

```yml title="compose.yml"
services:
  couchdb:
    image: couchdb:3
    container_name: obsidian-livesync
    user: "5984:5984"
    restart: unless-stopped

    environment:
      - COUCHDB_USER=CHANGE_ME
      - COUCHDB_PASSWORD=CHANGE_ME

    ports:
      - "10012:5984"

    volumes:
      - ./couchdb-data:/opt/couchdb/data
      - ./couchdb-config:/opt/couchdb/etc/local.d
    healthcheck:
      test:
        - CMD-SHELL
        - >
          curl -sfSL
          -u "$$COUCHDB_USER:$$COUCHDB_PASSWORD"
          http://127.0.0.1:5984/_up
      interval: 10s
      timeout: 5s
      retries: 12
      start_period: 20s
```

```ini title="local.ini"
[couchdb]
single_node=true
max_document_size = 50000000

[chttpd]
require_valid_user = true
max_http_request_size = 4294967296

[chttpd_auth]
require_valid_user = true
authentication_redirect = /e=_/_utils/session.html

[httpd]
WWW-Authenticate = Basic realm="couchdb"
enable_cors = true

[cors]
origins = app://obsidian.md,capacitor://localhost,http://localhost,https://obsidian-live-sync.domain.tld
credentials = true
headers = accept, authorization, content-type, origin, referer
methods = GET, PUT, POST, HEAD, DELETE
max_age = 3600

[log]
level = info
```

corsã®æ‰€ã®`https://obsidian-live-sync.domain.tld`ã¯ã€å¾Œã»ã©è¨­å®šã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã™ã€‚ã¾ãŸã€`CHANGE_ME`ã®éƒ¨åˆ†ã¯ã€é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

### 2. CouchDBã«å¯¾ã—ã¦LiveSyncã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹

å…¬å¼ã®[ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆå‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/vrtmrz/obsidian-livesync/blob/aa6d771d17bef94a4d29dfdf27500d522349d816/docs/setup_own_server.md)ã‚’å‚è€ƒã«ã€ä»¥ä¸‹ã®æ‰‹é †ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

bashã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

```console
>$ export hostname=localhost:10012
>$ export username=CHANGE_ME
>$ export password=CHANGE_ME
>$ curl -s https://raw.githubusercontent.com/vrtmrz/obsidian-livesync/main/utils/couchdb/couchdb-init.sh | bash
---
INFO: defaulting to _local
-- Configuring CouchDB by REST APIs... -->
{"ok":true}
"true"
"true"
"Basic realm=\"couchdb\""
"true"
""
"4294967296"
"50000000"
"true"
"app://obsidian.md,capacitor://localhost,http://localhost,https://obsidian-live-sync.domain.tld"
<-- Configuring CouchDB by REST APIs Done!
```

å¤‰æ•°ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã®ã¯ã€ã‚³ãƒãƒ³ãƒ‰æœ€ä¸‹éƒ¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…éƒ¨ã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚  
ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰Dockerã®CouchDBã¸ã®æ¥ç¶šã®ãŸã‚ã®æƒ…å ±ã«ãªã‚Šã¾ã™ã€‚

curlã§CouchDBã¸åˆæœŸåŒ–ã®å‘½ä»¤ã‚’é€ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ãªã£ã¦ã„ã¾ã™ã€‚


### 3. Nginxã§ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚’è¨­å®šã™ã‚‹

rootã§`/etc/nginx/conf.d`ã¸ã®è¨­å®šã®è¿½åŠ ã¨ã€ãƒªãƒ­ãƒ¼ãƒ‰ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã¾ã§è¡Œã„ã¾ã—ãŸã€‚

ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ã€å…ˆç¨‹ã®corsã§è¨­å®šã—ãŸ`https://obsidian-live-sync.domain.tld`ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

```console
># cd /etc/nginx/conf.d/
># vim 12_obsidian-live-sync.domain.tld.conf
># nginx -t
---
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
---
># systemctl reload nginx
># systemctl status nginx --no-pager
---
â— nginx.service - nginx web server
     Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; preset: disabled)
     Active: active (running) since Sun 2025-12-14 04:35:00 JST; 2 weeks 2 days ago
 Invocation: 94c3f1526d3f4bbe879ee81be9722441
    Process: 1830872 ExecReload=/usr/bin/nginx -s reload (code=exited, status=0/SUCCESS)
   Main PID: 6350 (nginx)
      Tasks: 2 (limit: 57477)
     Memory: 1G (peak: 1G)
        CPU: 2min 33.730s
     CGroup: /system.slice/nginx.service
             â”œâ”€   6350 "nginx: master process /usr/bin/nginx"
             â””â”€1830877 "nginx: worker process"
Dec 23 23:52:26 domain.tld systemd[1]: Reloaded nginx web server.
Dec 24 22:59:20 domain.tld systemd[1]: Reloading nginx web server...
Dec 24 22:59:20 domain.tld nginx[1078291]: 2025/12/24 22:59:20 [notice] 1078291#1078291: signal process started
Dec 24 22:59:20 domain.tld systemd[1]: Reloaded nginx web server.
Dec 28 11:04:24 domain.tld systemd[1]: Reloading nginx web server...
Dec 28 11:04:24 domain.tld nginx[1371000]: 2025/12/28 11:04:24 [notice] 1371000#1371000: signal process started
Dec 28 11:04:24 domain.tld systemd[1]: Reloaded nginx web server.
Dec 30 20:13:38 domain.tld systemd[1]: Reloading nginx web server...
Dec 30 20:13:38 domain.tld nginx[1830872]: 2025/12/30 20:13:38 [notice] 1830872#1830872: signal process started
Dec 30 20:13:38 domain.tld systemd[1]: Reloaded nginx web server.
```

Dockerå†…éƒ¨ã®CouchDBã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã®è¨­å®šã‚’ã—ã¦ã„ã‚‹ã®ã§ã€Nginxã®æ–¹ã§ã¯åˆ¶é™ã—ã¦ã„ã¾ã›ã‚“ã€‚  
Self-hosted LiveSyncç”¨ã®CouchDB(10012ãƒãƒ¼ãƒˆ)ã¸ã®ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã§ã™ã€‚

```nginx title="12_obsidian-live-sync.domain.tld.conf"
server {
    listen 80;
    server_name obsidian-live-sync.domain.tld;

    client_max_body_size 0;

    access_log /var/log/nginx/obsidian-live-sync.domain.tld_access.log main;
    error_log  /var/log/nginx/obsidian-live-sync.domain.tld_error.log warn;

    return 301 https://obsidian-live-sync.domain.tld$request_uri;
}

server {
    listen 443 ssl;
    server_name obsidian-live-sync.domain.tld;

    ssl_certificate     /opt/dehydrated/certs/domain.tld/fullchain.pem;
    ssl_certificate_key /opt/dehydrated/certs/domain.tld/privkey.pem;

    client_max_body_size 0;

    access_log /var/log/nginx/obsidian-live-sync.domain.tld_access.log main;
    error_log  /var/log/nginx/obsidian-live-sync.domain.tld_error.log warn;

    # ssl_client_certificate /opt/domain_ca/ca.crt;
    # ssl_verify_client on;

    location / {
        proxy_pass http://localhost:10012;

        proxy_http_version 1.1;
        proxy_set_header Host $host;

        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Real-IP $remote_addr;

        proxy_buffering off;
        proxy_redirect off;
    }
}
```

### 4. DNSã‚’è¨­å®šã™ã‚‹

æ›¸ãã¾ã§ã‚‚æœ‰ã‚Šã¾ã›ã‚“ãŒå¿µã®ç‚ºã€‚

å…ˆç¨‹ã®è¨­å®šã®`obsidian-live-sync.domain.tld`ã«ã‚ãŸã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¯¾ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹(NginxãŒ80,443ãƒãƒ¼ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€‚ç§ã®å ´åˆã¯å¤©ä¸‹ã®ã†ã‚“ã“ISPã€Nuroã®IPã§ã™ã€‚)ã«å‘ã‘ãŸãƒ¬ã‚³ãƒ¼ãƒ‰(CNAME,A)ã‚’ä½œæˆã—ã¾ã™ã€‚

æ­£ç¢ºã«ã¯å…ˆç¨‹Nginxã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ãŸæ™‚ç‚¹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ãŒã€DNSã‚’é€šã™ã“ã¨ã§æœ¬æ ¼çš„ã«DBãŒéœ²å‡ºã—ã¾ã™ç¬‘

ã“ã®æ®µéšã§ã€CouchDBã®ç®¡ç†ç”»é¢`https://obsidian-live-sync.domain.tld/_utils/`ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  
å…ˆç¨‹è¨­å®šã—ãŸ`CHANGE_ME`ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§Basicèªè¨¼ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚

![13-selfhost-obsidian-cross-platform-syncing/01-couchdb-test.png](/images/13-selfhost-obsidian-cross-platform-syncing/01-couchdb-test.png)
![13-selfhost-obsidian-cross-platform-syncing/02-couchdb-conpane.png](/images/13-selfhost-obsidian-cross-platform-syncing/02-couchdb-conpane.png)

çµæ§‹ãƒªãƒƒãƒãªã‚³ãƒ³ãƒ‘ãƒãŒä»˜å±ã—ã¦ã‚‹ã‚“ã§ã™ã­ã€‚

### 5. è¨­å®šç”¨URLã‚’ç”Ÿæˆã™ã‚‹

å…¬å¼ã«ã‚ˆã‚‹è¨­å®šæ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```console
export hostname=https://obsidian-live-sync.domain.tld
export database=obsidiannotes
export passphrase=ä»»æ„ã®E2EEãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚º
export username=CHANGE_ME
export password=CHANGE_ME
deno run -A https://raw.githubusercontent.com/vrtmrz/obsidian-livesync/main/utils/flyio/generate_setupuri.ts
```

ã¯ã„ã€‚ãªã‚“ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒ[Deno](https://deno.com/)ã«ä¾å­˜ã—ã¦ã¾ã—ãŸç¬‘  
ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒURLå½¢å¼ã¨ãªã£ã¦ã„ã‚‹ä»¥ä¸Šã€Denoä¾å­˜ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹å¼ãªã‚“ã§ã™ã­ã€‚

Denoã®URLã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã§ãã‚‹æ©Ÿèƒ½ã€å‰ã‹ã‚‰ç¥æ©Ÿèƒ½ã¨ã¯æ€ã£ã¦ã¾ã—ãŸãŒã€ã“ã‚“ãªã¨ã“ã‚ã§è¦‹ã‚‹ã“ã¨ã«ãªã‚‹ã¨ã¯ã€å°‘ã—æ„Ÿå‹•ã§ã™ã€‚

æ³¨æ„ç‚¹ã¨ã—ã¦ã€å¼•æ•°ã¨ã—ã¦æŒ‡å®šã—ã¦ã„ã‚‹`passphrase`ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹å†…å®¹ãŒæš—å·åŒ–ã•ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚  
ã¤ã¾ã‚Šã€ã“ã‚Œã‚’å¿˜ã‚Œã‚‹ã¨ã™ã¹ã¦ã®ãƒ¡ãƒ¢ãŒã‚´ãƒŸã¨åŒ–ã—ã¾ã™ã€‚

ä¸‡ãŒä¸€ã«å‚™ãˆã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€è¨­å®šã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚  
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å†…éƒ¨ã§`octagonal-wheels`ã¨ã„ã†ã€`obsidian-livesync`ã®ä½œè€…ãŒä½œæˆã—ã¦ã„ã‚‹npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ä¾å­˜ã—ã¦ã„ã¾ã™ãŒã€ã“ã¡ã‚‰ã¯npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹ä»¥ä¸Šçªç„¶ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚‹ã“ã¨ã¯ãªã•ãã†ãªã®ã§æ”¾ç½®ã—ã¦ã„ã¾ã™ã€‚


```console
>$ cd ~/apps/obsidian-livesync
>$ curl -sfSLo generate_setupuri.ts https://raw.githubusercontent.com/vrtmrz/obsidian-livesync/main/utils/flyio/generate_setupuri.ts
>$ echo "hostname=https://obsidian-live-sync.domain.tld" >> .env
>$ echo "database=obsidiannotes" >> .env
>$ echo "passphrase=ä»»æ„ã®E2EEãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚º" >> .env
>$ echo "username=CHANGE_ME" >> .env
>$ echo "password=CHANGE_ME" >> .env
>$ deno run -A --env generate_setupuri.ts
---
Your passphrase of Setup-URI is:  *****
This passphrase is never shown again, so please note it in a safe place.
obsidian://setuplivesync?settings=******
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‡ºåŠ›ã‚’Obsidianä¸Šã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§åˆ©ç”¨ã—ã¾ã™ã€‚

### 6. Obsidian LiveSyncã‚’è¨­å®šã™ã‚‹

TODO

## å‚è€ƒ

[Obsidian ã®åŒæœŸã‚’è§£æ¶ˆã™ã‚‹ & Cloudflare é…ä¸‹ã§ãƒ›ã‚¹ãƒˆã™ã‚‹](https://blog.naa0yama.com/p/18w10-azvs93f1/)

